#!/bin/bash -x
# either move or copy given file, appending the
# last-modified date and timestamp to a filename

[ ${0##*/} = "cpdate" ] && CMD="cp -avi" || CMD="mv -vi"

[ -e "${@}" ] && name=${@%.*} && ext=.${@##*.} && {
    [ -n "${name}" ] || [ "${ext}" = ".${@}" ] && {
        name=${@} && ext=
    }
} && ${CMD} "${@}" "${name}_$(date -r "${@}" +'%F_%H%Mh')${ext}"

